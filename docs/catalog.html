<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>catalogue d’enquêtes de type OSINT — Investigations audiovisuelles</title>
  <!--
    catalog_osint_all_in_one.html — Version propre et stable
    - Fichier autonome (HTML unique), styles Tailwind via CDN, aucun fetch réseau pour les données
    - Charge vos données depuis window.DATA (ex: <script src="data_osint.js"></script> qui définit window.DATA = [...])
    - Filtres: Média, Auteurs, Thématique, Proactivité, IA, Période + recherche plein-texte
    - Cartes: bordure couleur thématique, logo média (Wikipédia) ou monogramme, puces IA/Proactivité/Thématique, auteurs en chips
    - Export CSV exact du sous-ensemble affiché
  -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .card-border{border-left-width:8px}
    .logo-fallback{display:flex;align-items:center;justify-content:center;border-radius:.5rem;background:#f1f5f9;color:#475569;font-weight:700}
    .link-icon{text-decoration:none}
  </style>
</head>
<body class="bg-white text-slate-900">
  <header class="sticky top-0 z-10 border-b border-slate-200 bg-gradient-to-r from-emerald-300 via-emerald-400 to-teal-400/90 backdrop-blur">
    <div class="max-w-6xl mx-auto px-4 py-5">
      <h1 class="text-2xl font-bold">catalogue d’enquêtes de type OSINT</h1>
      <p class="text-emerald-950/90">Investigations audiovisuelles</p>
      <div class="mt-4 bg-white/95 rounded-xl border border-slate-200 p-4 shadow-sm">
        <form id="filters" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3" aria-label="Filtres">
          <div>
            <label for="q" class="text-xs text-slate-600">Recherche</label>
            <input id="q" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2" placeholder="Titre, résumé, commentaire…" autocomplete="off" />
          </div>
          <div>
            <label for="media" class="text-xs text-slate-600">Média</label>
            <select id="media" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2"></select>
          </div>
          <div>
            <label for="authors" class="text-xs text-slate-600">Auteurs</label>
            <select id="authors" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2"></select>
          </div>
          <div>
            <label for="theme" class="text-xs text-slate-600">Thématique</label>
            <select id="theme" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2"></select>
          </div>
          <div>
            <label for="proact" class="text-xs text-slate-600">Proactivité</label>
            <select id="proact" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2">
              <option value="">(toutes)</option>
              <option value="proactive">proactive</option>
              <option value="reactive">reactive</option>
            </select>
          </div>
          <div>
            <label for="hasIA" class="text-xs text-slate-600">IA</label>
            <select id="hasIA" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2">
              <option value="">(tout)</option>
              <option value="yes">yes</option>
              <option value="no">no</option>
            </select>
          </div>
          <div>
            <label class="text-xs text-slate-600">Date — du</label>
            <input id="dfrom" type="date" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2" />
          </div>
          <div>
            <label class="text-xs text-slate-600">au</label>
            <input id="dto" type="date" class="w-full mt-1 rounded-lg border border-slate-300 px-3 py-2" />
          </div>
          <div class="flex items-end gap-2">
            <button type="button" id="reset" class="rounded-lg border border-slate-300 px-3 py-2 bg-white hover:border-emerald-500">Réinitialiser</button>
            <button type="button" id="export" class="rounded-lg border border-slate-300 px-3 py-2 bg-white hover:border-emerald-500">Exporter en CSV</button>
            <div class="ml-auto text-sm text-emerald-900" id="count"></div>
          </div>
        </form>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <section id="grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4" role="list"></section>

    <footer class="mt-8 text-sm text-emerald-900">
      <div class="rounded-xl border border-slate-200 p-4 bg-emerald-50">
        Projet <strong>MatrioscIA</strong>. Olivier Le Deuff, Thais Barbosa de Almeida, Rayya Roumanos, Mailuxa Pagola. 2025. Licence <strong>CC BY</strong>
      </div>
    </footer>
  </main>

  <!-- Chargez VOS données ici (avant le script principal) : un fichier qui fait window.DATA = [...] -->
  <script src="data_osint.js"></script>

  <script>
  // ========================= UTILITAIRES =========================
  const deaccent = (s='') => s.normalize('NFD').replace(/\p{Diacritic}/gu,'');
  const norm = (s='') => deaccent(String(s)).trim().toLowerCase().replace(/\s+/g,' ');
  const trim = (s) => (s??'').toString().trim();

  function parseDateLoose(val){
    const raw = trim(val); if(!raw) return { iso:'', date:null };
    const t = norm(raw).replace(/\./g,'/').replace(/-/g,'/');
    let m = t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);
    if(m){ let [_,d,mo,y]=m; if(y.length===2) y=(+y>50? '19'+y : '20'+y); const iso=`${y.padStart(4,'0')}-${String(mo).padStart(2,'0')}-${String(d).padStart(2,'0')}`; const date=new Date(iso); return isNaN(date)?{iso:'',date:null}:{iso,date}; }
    m = t.match(/^(\d{4})\/(\d{1,2})\/(\d{1,2})$/);
    if(m){ const [_,y,mo,d]=m; const iso=`${y}-${String(mo).padStart(2,'0')}-${String(d).padStart(2,'0')}`; const date=new Date(iso); return isNaN(date)?{iso:'',date:null}:{iso,date}; }
    const d = new Date(raw); if(!isNaN(d)){ const iso=d.toISOString().slice(0,10); return { iso, date:new Date(iso) }; }
    return { iso:'', date:null };
  }

  const IA_PAT = new RegExp([
    'intelligence\\s*artificielle','\\bIA\\b','I\\.A\\.','\\bAI\\b','LLM','deepfake','apprentissage\\s*automatique','deep\\s*learning','reseau\\s*neuronal','modele\\s*de\\s*langue','generatif','ChatGPT','OpenAI','Midjourney','Stable\\s*Diffusion','Llama','ElevenLabs','Suno'
  ].join('|'),'i');
  function hasIAFields({title,content,commentaire}){
    if(IA_PAT.test(commentaire||'')) return true;
    return IA_PAT.test(`${title||''} ${content||''}`);
  }

  function normPro(raw, ctx){
    const v=norm(raw||''); if(v.includes('proact')) return 'proactive'; if(v.includes('react')) return 'reactive';
    const hay = norm(`${ctx.title||''} ${ctx.content||''} ${ctx.commentaire||''}`);
    if(/(fact ?check|vrai|faux|desinfo|debunk|verification)/.test(hay)) return 'reactive';
    if(/(enquete|investigation|osint|cartograph|geolocalis|analyse)/.test(hay)) return 'proactive';
    return '';
  }

  function splitAuthors(raw){
    const r=(raw||'').toString();
    const parts=r.split(/\s*(?:\||,|;|\/|\bet\b|&|\band\b)\s*/i).map(s=>s.trim()).filter(Boolean);
    const seen=new Set(), out=[]; for(const p of parts){ const k=norm(p); if(!seen.has(k)){ seen.add(k); out.push(p); } }
    return out;
  }

  const THEME_COLORS={
    'humanitaire':'#8b5cf6',
    'problematiques environnementales':'#10b981', 'problematique environnementale':'#10b981',
    'strategies militaires':'#8B4513',
    'strategies militaires et influence':'#78866B',
    'crime organise':'#000000',
    "repression de l'etat":'#f97316', "repression de l’etat":'#f97316', "repression de l etat":'#f97316',
    "approfondissement de l'actualite":'#3b82f6', "approfondissement de l’actualite":'#3b82f6',
    'catastrophes naturelles':'#ef4444'
  };
  function themeKey(raw){ return norm(raw).replace(/’/g,"'"); }
  function themeColor(raw){ const k=themeKey(raw); if(THEME_COLORS[k]) return THEME_COLORS[k]; let h=0; for(let i=0;i<k.length;i++) h=(h*31+k.charCodeAt(i))>>>0; h%=360; return `hsl(${h} 55% 45%)`; }
  function themeLabel(raw){ const t=(raw||'').toString().trim(); return t? t.replace(/’/g,"'") : 'Sans thématique'; }
  function contrast(hex){ if(hex.startsWith('hsl')) return '#000'; const h=hex.replace('#',''); let r,g,b; if(h.length===3){r=parseInt(h[0]+h[0],16);g=parseInt(h[1]+h[1],16);b=parseInt(h[2]+h[2],16);} else {r=parseInt(h.slice(0,2),16);g=parseInt(h.slice(2,4),16);b=parseInt(h.slice(4,6),16);} const lum=(0.299*r+0.587*g+0.114*b)/255; return lum>0.55?'#111':'#fff'; }

  const LOGOS={
    'AFP':'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Agence_France-Presse_logo.svg/320px-Agence_France-Presse_logo.svg.png',
    'France 24':'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2e/France_24_logo.svg/320px-France_24_logo.svg.png',
    'Le Monde':'https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Le_Monde.svg/320px-Le_Monde.svg.png',
    'Libération':'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Logo_Lib%C3%A9ration.svg/320px-Logo_Lib%C3%A9ration.svg.png',
    'Le Figaro':'https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Le_Figaro_logo_2009.svg/320px-Le_Figaro_logo_2009.svg.png',
    'Mediapart':'https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Mediapart_logo.svg/320px-Mediapart_logo.svg.png',
    'Arte':'https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Arte_Logo_2017.svg/320px-Arte_Logo_2017.svg.png',
    'The New York Times':'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/The_New_York_Times_logo_variation.jpg/320px-The_New_York_Times_logo_variation.jpg',
    'The Washington Post':'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Washington_Post_logo_2014.svg/320px-Washington_Post_logo_2014.svg.png',
    'Reuters':'https://upload.wikimedia.org/wikipedia/commons/thumb/5/59/Reuters_Logo.svg/320px-Reuters_Logo.svg.png',
    'BBC':'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/BBC_Logo_2021.svg/320px-BBC_Logo_2021.svg.png',
    'The Guardian':'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/The_Guardian_2018.svg/320px-The_Guardian_2018.svg.png',
    'Associated Press':'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Associated_Press_logo_2012.svg/320px-Associated_Press_logo_2012.svg.png',
    'Bellingcat':'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Bellingcat_logo.svg/320px-Bellingcat_logo.svg.png'
  };
  function normMedia(m){
    const s=norm(m); if(!s) return '';
    if(/afp/.test(s)) return 'AFP';
    if(/observateur/.test(s) || /les observateurs/.test(s)) return 'France 24';
    if(/france ?24/.test(s)) return 'France 24';
    if(/le monde/.test(s)) return 'Le Monde';
    if(/lib[eé]ration/.test(s)) return 'Libération';
    if(/figaro/.test(s)) return 'Le Figaro';
    if(/mediapart/.test(s)) return 'Mediapart';
    if(/new york times|nyt/.test(s)) return 'The New York Times';
    if(/washington post/.test(s)) return 'The Washington Post';
    if(/reuters/.test(s)) return 'Reuters';
    if(/bbc/.test(s)) return 'BBC';
    if(/guardian/.test(s)) return 'The Guardian';
    if(/associated\s*press|\bap\b/.test(s)) return 'Associated Press';
    if(/bellingcat/.test(s)) return 'Bellingcat';
    if(/arte/.test(s)) return 'Arte';
    return (m||'').toString().trim();
  }
  function logoFor(media){ const key=normMedia(media); const url=LOGOS[key]; if(url) return {url,alt:key}; const mono=(key||'?').split(/\s+/).map(w=>w[0]||'').join('').slice(0,3).toUpperCase(); return {url:'',alt:mono,mono}; }

  function firstURL(val){
    const raw=val==null? '': String(val).trim();
    const urlRe=/(https?:\/\/)?([\w-]+\.)+[\w-]{2,}(\/[\w\-._~:\/?#[\]@!$&'()*+,;=%]*)?/i;
    try{
      const parsed = JSON.parse(raw);
      if(Array.isArray(parsed)){
        for(const x of parsed){ const m=String(x).match(urlRe); if(m) return m[0].startsWith('http')?m[0]:'https://'+m[0]; }
      } else if(parsed && typeof parsed==='object'){
        for(const v of Object.values(parsed)){ const m=String(v).match(urlRe); if(m) return m[0].startsWith('http')?m[0]:'https://'+m[0]; }
      }
    }catch(_){/* chaîne simple */}
    const m = raw.match(urlRe); return m? (m[0].startsWith('http')?m[0]:'https://'+m[0]) : '';
  }

  // ========================= CHARGEMENT & NORMALISATION =========================
  const DATA_SAMPLE = [
    { title:'How the Las Vegas Gunman Planned a Massacre', content:'Surveillance footage…', begin:'2018-03-22', media:'The New York Times', 'meta:links':'https://www.nytimes.com/video/us/100000005794914/las-vegas-gunman-planned-massacre.html', commentaire:'', auteurs:'', thématique:'stratégies militaires et influence', 'proactivité/réactivité':'proactive' },
    { title:"Explosion à l’hôpital Al-Ahli à Gaza : ce que montre l’analyse des images", content:'Deux jours après…', begin:'2023-10-19', media:'Le Monde', 'meta:links':'https://www.lemonde.fr/international/article/2023/10/19/explosion-a-l-hopital-al-ahli-a-gaza-ce-que-montre-l-analyse-detaillee-des-images_6195448_3210.html', commentaire:'', auteurs:'', thématique:"stratégies militaires et influence", 'proactivité/réactivité':'reactive' }
  ];
  const RAW = Array.isArray(window.DATA)? window.DATA : DATA_SAMPLE;
  console.log(`[catalog-osint] fiches intégrées: ${RAW.length}`);

  function mapRecord(r){
    const title = trim(r.title || r.Titre || r.titre || r.TITLE);
    const content = trim(r.content || r.resume || r.résumé || r.Résumé || r.Summary || r.summary || '');
    const begin = trim(r.begin || r.date || r['Date de publication'] || r['date de publication'] || r['Date'] || r['DATE'] || '');
    const mediaRaw = trim(r.media || r['Lieu de publication'] || r.Média || r.media_name || '');
    const media = normMedia(mediaRaw);
    const link = firstURL(r['meta:links'] ?? r.links ?? r['Lien'] ?? r['URL'] ?? '');
    const commentaire = trim(r.commentaire || r.notes || r['comment'] || '');
    const authorsRaw = trim(r.auteurs || r['auteur·e·s'] || r['auteurs'] || r['authors'] || r['author'] || '');
    const authors = splitAuthors(authorsRaw);
    const themeRaw = trim(r.thématique || r['thematique'] || r['Thématique'] || r['Thème'] || r['theme'] || r['Theme'] || '');
    const tKey = themeKey(themeRaw);
    const tColor = themeColor(themeRaw);
    const tLabel = themeLabel(themeRaw);
    const proact = normPro(r['proactivité/réactivité'] || r['proactivite/reactivite'] || r['proactivité'] || r['proactivite'] || r['pro'] || r['type'] || '', {title,content,commentaire});
    const ia = hasIAFields({title,content,commentaire});
    const { iso, date } = parseDateLoose(begin);

    return { title, content, dateISO: iso, date, media, link, commentaire, authors, themeKey: tKey, themeColor: tColor, themeLabel: tLabel, proact, hasIA: ia };
  }

  const ENRICHED = RAW.map(mapRecord)
    .sort((a,b)=> (b.date?.getTime()||0) - (a.date?.getTime()||0) || a.title.localeCompare(b.title));
  const TOTAL = ENRICHED.length;

  // ========================= OPTIONS DES FILTRES =========================
  const byAlpha=(a,b)=> a.localeCompare(b);
  const medias = Array.from(new Set(ENRICHED.map(x=>x.media).filter(Boolean))).sort(byAlpha);
  const allAuthors = Array.from(new Set(ENRICHED.flatMap(x=>x.authors).filter(Boolean))).sort(byAlpha);
  const themeMap = new Map();
  for(const x of ENRICHED){ if(!themeMap.has(x.themeKey)) themeMap.set(x.themeKey, x.themeLabel); }
  const themes = Array.from(themeMap.entries()).map(([k,l])=>({k,l})).sort((a,b)=>a.l.localeCompare(b.l));

  const $ = sel=>document.querySelector(sel);
  function setOptions(el, values, placeholder){ el.innerHTML=''; const o=document.createElement('option'); o.value=''; o.textContent=placeholder||'(toutes)'; el.appendChild(o); for(const v of values){ const opt=document.createElement('option'); opt.value=v; opt.textContent=v; el.appendChild(opt);} }

  setOptions(document.getElementById('media'), medias, '(tous)');
  setOptions(document.getElementById('authors'), allAuthors, '(tous)');
  (function(){ const el=document.getElementById('theme'); el.innerHTML=''; const o=document.createElement('option'); o.value=''; o.textContent='(toutes)'; el.appendChild(o); for(const {k,l} of themes){ const opt=document.createElement('option'); opt.value=k; opt.textContent=l; el.appendChild(opt);} if(!themes.length){ const opt=document.createElement('option'); opt.value='(sans)'; opt.textContent='(sans thématique)'; el.appendChild(opt);} })();

  const dates = ENRICHED.map(x=>x.date).filter(Boolean).sort((a,b)=>a-b);
  if(dates.length){ const toISO=d=>d.toISOString().slice(0,10); document.getElementById('dfrom').min=toISO(dates[0]); document.getElementById('dto').min=toISO(dates[0]); document.getElementById('dfrom').max=toISO(dates.at(-1)); document.getElementById('dto').max=toISO(dates.at(-1)); }

  // ========================= RENDU CARTE =========================
  function card(item){
    const mediaLogo = logoFor(item.media);
    const proChipCls = item.proact==='proactive' ? 'bg-emerald-600 text-white' : (item.proact==='reactive' ? 'bg-amber-600 text-white' : 'bg-slate-200 text-slate-700');
    const themeBg = item.themeColor || '#94a3b8';
    const themeTxt = contrast(themeBg);
    const dateStr = item.date ? new Intl.DateTimeFormat('fr-FR',{year:'numeric',month:'long',day:'2-digit'}).format(item.date) : '(date manquante)';

    return `
    <article class="card-border rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden" style="border-left-color:${themeBg}" role="listitem">
      <div class="p-4 space-y-3">
        <div class="flex items-center gap-3">
          ${mediaLogo.url ? `<img src="${mediaLogo.url}" alt="${mediaLogo.alt}" class="w-10 h-10 object-contain rounded"/>` : `<div class="logo-fallback w-10 h-10">${mediaLogo.mono||'?'}</div>`}
          <h3 class="text-base font-semibold leading-snug">${item.title||'(titre manquant)'}</h3>
        </div>
        <p class="text-sm text-slate-700">${item.content||''}</p>
        <div class="flex flex-wrap gap-1.5">
          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-700">${item.media||'—'}</span>
          ${item.hasIA ? `<span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800">IA</span>` : ''}
          ${item.proact? `<span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${proChipCls}">${item.proact}</span>`:''}
          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium" style="background:${themeBg}; color:${themeTxt}; border:1px solid ${themeBg}">${item.themeLabel||'Sans thématique'}</span>
          ${item.authors.map(a=>`<span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-slate-100 text-slate-700">${a}</span>`).join('')}
        </div>
        <div class="flex items-center justify-between text-sm text-slate-600">
          <span>${dateStr}</span>
          ${item.link? `<a class="link-icon" href="${item.link}" target="_blank" rel="noopener" title="Ouvrir"><span aria-hidden="true">🔗</span><span class="sr-only">Ouvrir le lien</span></a>` : '<span class="text-slate-400">(pas de lien)</span>'}
        </div>
      </div>
    </article>`;
  }

  // ========================= FILTRES =========================
  const state={ q:'', media:'', author:'', theme:'', proact:'', hasIA:'', dfrom:'', dto:'' };
  function applyFilters(){
    const q = norm(state.q);
    let out = ENRICHED.filter(x=>{
      if(q){ const hay = norm(`${x.title} ${x.content} ${x.commentaire}`); if(!hay.includes(q)) return false; }
      if(state.media && x.media!==state.media) return false;
      if(state.author && !x.authors.includes(state.author)) return false;
      if(state.theme && x.themeKey!==state.theme) return false;
      if(state.proact && x.proact!==state.proact) return false;
      if(state.hasIA){ if(state.hasIA==='yes' && !x.hasIA) return false; if(state.hasIA==='no' && x.hasIA) return false; }
      if(state.dfrom){ if(!x.date || x.date < new Date(state.dfrom)) return false; }
      if(state.dto){ const lim=new Date(state.dto); lim.setHours(23,59,59,999); if(!x.date || x.date > lim) return false; }
      return true;
    });
    out = out.sort((a,b)=> (b.date?.getTime()||0) - (a.date?.getTime()||0) || a.title.localeCompare(b.title));
    document.getElementById('grid').innerHTML = out.map(card).join('');
    document.getElementById('count').textContent = `${out.length} résultat(s) affiché(s) / ${TOTAL}`;
    return out;
  }

  function bind(){
    const f = document.getElementById('filters');
    const ids = ['q','media','authors','theme','proact','hasIA','dfrom','dto'];
    ids.forEach(id=>{
      f.querySelector('#'+id).addEventListener('input', (e)=>{
        if(id==='authors') state.author = e.target.value; else if(id==='theme') state.theme=e.target.value; else state[id]=e.target.value;
        applyFilters();
      });
      f.querySelector('#'+id).addEventListener('change', (e)=>{
        if(id==='authors') state.author = e.target.value; else if(id==='theme') state.theme=e.target.value; else state[id]=e.target.value;
        applyFilters();
      });
    });

    document.getElementById('reset').addEventListener('click', ()=>{
      state.q=state.media=state.author=state.theme=state.proact=state.hasIA=state.dfrom=state.dto='';
      ids.forEach(id=>{ const el=f.querySelector('#'+id); if(el) el.value=''; });
      applyFilters();
    });

    document.getElementById('export').addEventListener('click', ()=>{
      const rows=applyFilters();
      const headers=['title','content','date','media','link','commentaire','authors','theme','proact','hasIA'];
      const csv=[headers.join(',')].concat(rows.map(r=>{
        const vals=[r.title,r.content,r.dateISO,r.media,r.link,r.commentaire,r.authors.join(' | '),r.themeLabel,r.proact,r.hasIA?'yes':'no'];
        return vals.map(v=> '"'+ String(v??'').replace(/"/g,'""') +'"').join(',');
      })).join('\n');
      const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='export_catalog_osint.csv'; a.click(); URL.revokeObjectURL(a.href);
    });
  }

  bind();
  applyFilters();
  </script>
</body>
</html>
