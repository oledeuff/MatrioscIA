<!doctype html>
<html lang="fr">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MatrioscIA â€” Personas OSINT & IA (alignÃ©s sur la matrice)</title>
<style>
:root{--bg:#0b1020;--panel:#0f172a;--ink:#e5e7eb;--muted:#cbd5e1;--bord:#1f2a44;--accent:#93c5fd;--table-head:#0b122c;}
:root.light{--bg:#f7f9fb;--panel:#ffffff;--ink:#0f172a;--muted:#475569;--bord:#e2e8f0;--accent:#3b82f6;--table-head:#f1f5f9;}
*{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink)}
.header{padding:16px 22px;border-bottom:1px solid var(--bord);background:linear-gradient(180deg,rgba(16,24,64,.35), rgba(11,16,32,1));position:sticky;top:0;z-index:10}
.header .wrap{max-width:1160px;margin:0 auto;display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
.brand{display:flex;align-items:center;gap:12px}.badge{background:linear-gradient(90deg,#17324D,#1C6EA4 55%,#46B3E6);color:#fff;padding:6px 12px;border-radius:999px;font-weight:700;font-size:.9em}
h1{margin:0;font-size:1.25rem}.controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.controls input,.controls select,.controls a,.controls button{background:var(--panel);color:var(--ink);border:1px solid var(--bord);padding:8px 10px;border-radius:10px;text-decoration:none}
.controls button{cursor:pointer}.wrap{max-width:1160px;margin:0 auto;padding:18px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:14px}
.card{position:relative;background:var(--panel);border:1px solid var(--bord);border-radius:14px;overflow:hidden}
.card::before{content:"";position:absolute;inset:0 0 auto 0;height:6px;background:var(--card-color,#93c5fd)}
.head{display:flex;gap:14px;padding:14px;border-bottom:1px solid var(--bord)}.illu{width:80px;height:80px;border-radius:12px;background:linear-gradient(135deg,#17324D,#1C6EA4 60%,#46B3E6);display:grid;place-items:center;flex:0 0 auto}
.illu svg{width:58px;height:58px;filter:drop-shadow(0 4px 16px rgba(0,0,0,.25))}.meta{display:flex;flex-direction:column;gap:4px;min-width:0}.title{font-size:1.05rem;font-weight:700}.kicker{font-size:.9rem;color:var(--muted)}
.chips{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}.chip{font-size:.78rem;border:1px solid var(--bord);color:var(--ink);padding:4px 8px;border-radius:999px;background:rgba(147,197,253,.12)}
.body{padding:14px;display:grid;grid-template-columns:1.1fr 1fr;gap:16px}@media (max-width:900px){.body{grid-template-columns:1fr}}.body h4{margin:.2rem 0 .4rem;color:var(--accent)}.body ul{margin:.2rem 0 1rem 1.1rem}.body li{margin:.2rem 0}
.note{font-size:.85rem;color:var(--muted)}.footer{display:flex;justify-content:space-between;align-items:center;padding:10px 0 2px;color:var(--muted);font-size:.85rem}hr{border:none;border-top:1px solid var(--bord);margin:18px 0}.small{font-size:.85rem}a{color:var(--accent)}
</style>

<header class="header">
  <div class="wrap">
    <div class="brand"><div class="badge">MatrioscIA</div><h1>Personas (alignÃ©s sur la matrice)</h1></div>
    <div class="controls">
      <a href="matrice.html" target="_blank" rel="noopener">â†©ï¸ Matrice</a>
      <input id="q" placeholder="Rechercher (persona, rÃ´le, besoinsâ€¦)" />
      <select id="os"><option value="">OSINT â€” Tous</option><option>Faible</option><option>Moyen</option><option>Fort</option><option>Moyen Ã  fort</option><option>Fort Ã  trÃ¨s fort</option></select>
      <select id="ia"><option value="">IA â€” Tous</option><option>Absente ou trÃ¨s faible</option><option>Absente Ã  exploratoire</option><option>Exploratoire ou ponctuelle</option><option>IntÃ©grÃ©e ou en dÃ©veloppement</option><option>En dÃ©veloppement ou intÃ©grÃ©e</option></select>
      <select id="fam"><option value="">Famille (matrice) â€” Toutes</option>
        <option>MÃ©diateurs rÃ©flexifs et  critiques</option>
        <option>Explorateurs critiques</option>
        <option>Artisans du rÃ©cit</option>
        <option>EnquÃªteurs augmentÃ©s</option>
        <option>Gestionnaires techniques et solutionnistes</option>
        <option>IngÃ©nieurs de la preuve</option>
      </select>
      <select id="fn"><option value="">Fonction (Lewis et al.) â€” Toutes</option><option>Attentionnelle</option><option>Orientationnelle</option><option>Signalisation</option><option>Mobilisation</option><option>RÃ©flexive</option></select>
      <button id="themeBtn">Palette clair/sombre</button>
      <button id="exportBtn">Exporter JSON</button>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="small"><p>CatÃ©gorisation stricte selon la <em>matrice</em>. Les couleurs (bandeau des cartes) utilisent les <strong>mÃªmes codes hex</strong> que la matrice.</p><hr></section>
  <section class="grid" id="cards"></section>
  <section><hr><div class="footer">
    <div>ğŸ‘¤ Cette page â€” ğŸ§© <a href="matrice.html">Matrice</a></div>
    <div>RÃ©f. : Lewis, Zamith & Bunquin (2025) â€” <a href="https://doi.org/10.1080/21670811.2025.2557994" target="_blank" rel="noopener">doi</a></div>
  </div></section>
</main>

<script>
const SILH = {
  neutral:`<svg viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#fff" stop-opacity=".95"/><stop offset="1" stop-color="#e8f3ff" stop-opacity=".9"/></linearGradient></defs><circle cx="64" cy="64" r="58" fill="url(#g)" /><path d="M32 88c8-8 24-10 32-10s24 2 32 10c4 4 6 9 6 14v6H26v-6c0-5 2-10 6-14z" fill="#17324D" opacity=".9"/><circle cx="64" cy="52" r="22" fill="#17324D" opacity=".95"/></svg>`,
  longhair:`<svg viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><defs><linearGradient id="g2" x1="0" x2="1"><stop offset="0" stop-color="#fff" stop-opacity=".95"/><stop offset="1" stop-color="#f1f9ff" stop-opacity=".9"/></linearGradient></defs><circle cx="64" cy="64" r="58" fill="url(#g2)"/><path d="M32 88c8-8 24-10 32-10s24 2 32 10c4 4 6 9 6 14v6H26v-6c0-5 2-10 6-14z" fill="#1C6EA4" opacity=".9"/><path d="M34 52c0-14 12-26 30-26s30 12 30 26c0 7-2 12-6 18-5-3-13-5-24-5s-19 2-24 5c-4-6-6-11-6-18z" fill="#17324D" opacity=".95"/></svg>`,
  beard:`<svg viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><defs><linearGradient id="g3" x1="0" x2="1"><stop offset="0" stop-color="#fff" stop-opacity=".95"/><stop offset="1" stop-color="#eef6ff" stop-opacity=".9"/></linearGradient></defs><circle cx="64" cy="64" r="58" fill="url(#g3)"/><path d="M32 88c8-8 24-10 32-10s24 2 32 10c4 4 6 9 6 14v6H26v-6c0-5 2-10 6-14z" fill="#17324D" opacity=".9"/><circle cx="64" cy="52" r="20" fill="#17324D" opacity=".95"/><path d="M44 60c4 8 10 14 20 14s16-6 20-14c0 10-8 24-20 24S44 70 44 60z" fill="#1C6EA4"/></svg>`
};

// EXACT same hex colors as matrice.html
const FAMILLE_COLORS = {
  "MÃ©diateurs rÃ©flexifs et  critiques":"#7C3AED",
  "Explorateurs critiques":"#F59E0B",
  "Artisans du rÃ©cit":"#EF4444",
  "EnquÃªteurs augmentÃ©s":"#3B82F6",
  "Gestionnaires techniques et solutionnistes":"#10B981",
  "IngÃ©nieurs de la preuve":"#8B5CF6"
};

// Personas â€” familles alignÃ©es strictement sur l'une des 6 catÃ©gories ci-dessus
const PERSONAS = [
  {"id":"p1","nom":"Persona A","role":"Investigatrice OSINT â€” cellule proactive (enquÃªte longue)","niveau_osint":"Fort","niveau_ia":"Moyen","fonction":"Orientationnelle","silhouette":"longhair","famille":"EnquÃªteurs augmentÃ©s","pitch":"ConÃ§oit des enquÃªtes probatoires ; lâ€™IA est utile si elle renforce la preuve.","objectifs":["Preuves robustes et auditables","Automatiser OCR/repÃ©rage/entitÃ©s sans boÃ®te noire","Formats innovants sans sacrifier la mÃ©thode"],"outils":["Imagerie ouverte/comm.","OCR + similaritÃ©","LLM (rÃ©sumÃ©s contrÃ´lÃ©s)","Montage/SIG","Automatisations lÃ©gÃ¨res"],"besoins":["Temps POC","AccÃ¨s imagerie ponctuel","Appui dev pour scripts"],"vigilance":["Hallucinations de rÃ©sumÃ©s","Biais de dÃ©tection image","CoÃ»t/confidentialitÃ©"],"indicateurs":["RÃ©utilisation scripts","Temps gagnÃ© vÃ©rifs","Assertions reliÃ©es Ã  des preuves"],"citation":"Â« Lâ€™IA mâ€™aide Ã  prouver et documenter. Â»"},
  {"id":"p2","nom":"Persona B","role":"VÃ©rificateur rÃ©actif (audio/visuel)","niveau_osint":"Fort","niveau_ia":"Moyen","fonction":"Attentionnelle","silhouette":"beard","famille":"Explorateurs critiques","pitch":"DÃ©piste manipulations et deepfakes ; lâ€™IA sert dâ€™alerte, jamais de verdict.","objectifs":["RÃ©duire temps de tri","TraÃ§abilitÃ© publique minimale","Sensibiliser Ã  la dÃ©tection AV"],"outils":["Transcription auto","Indices forensics","Recherche inversÃ©e","LLM pour hypothÃ¨ses contradictoires"],"besoins":["ModÃ¨les audio deepfake","Dashboard dâ€™alerting","ProcÃ©dure de publication transparente"],"vigilance":["Faux positifs spectaculaires","OpacitÃ© API","Biais accents/qualitÃ©"],"indicateurs":["DÃ©lai dÃ©tectionâ†’publication","Faux positifs Ã©vitÃ©s","EncadrÃ© mÃ©thodo prÃ©sent"],"citation":"Â« Lâ€™algo propose, lâ€™Ã©quipe dispose. Â»"},
  {"id":"p3","nom":"Persona C","role":"Analyste imagerie â€” enquÃªtes gÃ©ospatiales","niveau_osint":"Fort Ã  trÃ¨s fort","niveau_ia":"En dÃ©veloppement ou intÃ©grÃ©e","fonction":"Orientationnelle","silhouette":"neutral","famille":"IngÃ©nieurs de la preuve","pitch":"Combine imagerie avec dÃ©tection assistÃ©e ; double vÃ©rification humaine.","objectifs":["Gains de temps sur balayages larges","RÃ©duction du bruit algorithmique","MÃ©thodes reproductibles"],"outils":["Vision par ordinateur","SIG raster/vector","Pipelines notariÃ©s"],"besoins":["Datasets annotÃ©s","Budget imagerie","Calcul ponctuel"],"vigilance":["Sur-ajustement","Heatmaps mal interprÃ©tÃ©es","ChaÃ®ne de garde"],"indicateurs":["PrÃ©cision ajustÃ©e Ã  la tÃ¢che","% Ã©vÃ©nements confirmÃ©s","Temps/kmÂ²"],"citation":"Â« Lâ€™IA regarde partout ; la preuve reste humaine. Â»"},
  {"id":"p4","nom":"Persona D","role":"RÃ©fÃ©rent technique / communautÃ©","niveau_osint":"Moyen","niveau_ia":"IntÃ©grÃ©e ou en dÃ©veloppement","fonction":"Mobilisation","silhouette":"beard","famille":"Gestionnaires techniques et solutionnistes","pitch":"Acculture la communautÃ©, maintient outillage et guides de traÃ§abilitÃ©.","objectifs":["Former par la pratique","Standards dâ€™audit simples","Mutualiser scripts/checklists"],"outils":["Notebooks reproductibles","Guides OSINT responsable","Espace communautaire","CI/tests"],"besoins":["Maintenance","Financement open source","InteropÃ©rabilitÃ© API"],"vigilance":["DÃ©pendances SaaS","Perte de doc","Turnover contributeurs"],"indicateurs":["Adoption guides","Contributions/sem.","Taux de reproduction"],"citation":"Â« Documenter augmente la puissance dâ€™agir. Â»"},
  {"id":"p5","nom":"Persona E","role":"Pigiste OSINT (multi-rÃ©dactions)","niveau_osint":"Basique au service du rÃ©cit","niveau_ia":"Exploratoire ou ponctuelle","fonction":"Signalisation","silhouette":"longhair","famille":"Artisans du rÃ©cit","pitch":"PrÃ©sente des angles Â« mÃ©thode + preuve Â» ; outils accessibles.","objectifs":["CrÃ©dibilitÃ© auprÃ¨s des desks","Standardiser preuves/captures","Automatiser tÃ¢ches ingrates"],"outils":["Archivage/capture","Traduction/transcription","Tableurs","LLM pour briefs/checklists"],"besoins":["Outils pro abordables","Templates de preuve","Mentorat technique ponctuel"],"vigilance":["Surestimation IA","SÃ©curitÃ© opÃ©","Protection non-publics"],"indicateurs":["Taux dâ€™acceptation de pitch","DÃ©lai pitchâ†’publication","Erreurs Ã©vitÃ©es"],"citation":"Â« Je vends la mÃ©thode avant lâ€™histoire. Â»"},
  {"id":"p6","nom":"Persona F","role":"Ã‰diteur / Chef de desk","niveau_osint":"Faible Ã  moyen","niveau_ia":"Absente ou trÃ¨s faible","fonction":"RÃ©flexive","silhouette":"neutral","famille":"MÃ©diateurs rÃ©flexifs et  critiques","pitch":"CohÃ©rence Ã©ditoriale et transparence : oÃ¹ place-t-on la machine, oÃ¹ garde-t-on lâ€™humain ?","objectifs":["Charte IA","Transparence mÃ©thodes","Arbitrage coÃ»ts/valeurs"],"outils":["Guide IA/OSINT","Journal dâ€™audit","Tableau de risques"],"besoins":["Concertation","Veille juridique/Ã©thique","Formation courte"],"vigilance":["Solutionnisme techno","OpacitÃ© fournisseurs","Ã‰rosion des compÃ©tences cÅ“ur"],"indicateurs":["Charte adoptÃ©e","% encadrÃ©s mÃ©thodo","Satisfaction rÃ©daction"],"citation":"Â« On documente pour pouvoir expliquer. Â»"},
  {"id":"p7","nom":"Persona G","role":"Analyste institutionnel (intÃ©rÃªt public)","niveau_osint":"Moyen Ã  fort","niveau_ia":"Absente Ã  exploratoire","fonction":"Mobilisation","silhouette":"beard","famille":"EnquÃªteurs augmentÃ©s","pitch":"DÃ©tecte campagnes dâ€™ingÃ©rence ; outille les analystes ; interprÃ©tation humaine dâ€™abord.","objectifs":["DÃ©tection prÃ©coce multi-plateformes","Autonomie via datalab","Partage mÃ©thodes"],"outils":["Clustering thÃ©matique","Transcription","Analyse de vignettes vidÃ©o","Pipelines prudents"],"besoins":["DonnÃ©es ouvertes de qualitÃ©","RÃ©tention gouvernÃ©e","CoopÃ©rations acad/OSINT"],"vigilance":["Bruit massif","Biais dâ€™attribution","Stigmatisation"],"indicateurs":["DÃ©lai dÃ©tectionâ†’qualification","Faux positifs","MÃ©thodes publiÃ©es"],"citation":"Â« Beaucoup dâ€™IA, encore plus dâ€™humains. Â»"},
  {"id":"p8","nom":"Persona H","role":"MÃ©diatrice Ã©thique & documentation","niveau_osint":"Faible Ã  moyen","niveau_ia":"Absente ou trÃ¨s faible","fonction":"RÃ©flexive","silhouette":"longhair","famille":"MÃ©diateurs rÃ©flexifs et  critiques","pitch":"Fait tenir pÃ©dagogie, traÃ§abilitÃ© et justice procÃ©durale.","objectifs":["ChaÃ®nes de traitement lisibles","Formation aux cadres","Revue par les pairs"],"outils":["Guides thÃ©oriques","Tableaux de preuve","ModÃ¨les dâ€™encadrÃ©"],"besoins":["Temps de formation","Soutien Ã©ditorial","Journalisation simple"],"vigilance":["PÃ©dagogie tokenisÃ©e","Sous-traitance Ã©thique","Fatigue documentaire"],"indicateurs":["% enquÃªtes avec chaÃ®nes complÃ¨tes","Feedback lecteurs","RÃ©utilisation gabarits"],"citation":"Â« Lâ€™adoption, pas lâ€™adaptation â€” une greffe choisie. Â»"},
  {"id":"p9","nom":"Persona I","role":"Journaliste reporter TV (terrain)","niveau_osint":"Basique au service du rÃ©cit","niveau_ia":"Absente ou trÃ¨s faible","fonction":"Signalisation","silhouette":"beard","famille":"Artisans du rÃ©cit","pitch":"OSINT pragmatique (repÃ©rages/vÃ©rifs). TrÃ¨s peu dâ€™IA ; posture critique.","objectifs":["RepÃ©rages rapides","VÃ©rifier images/social avant antenne","TraÃ§abilitÃ© minimale Ã  lâ€™antenne"],"outils":["Recherche inversÃ©e","GÃ©oloc basique","Listes/flux sources","Checklists vÃ©rif"],"besoins":["Outils simples/mobiles/offline","Formation courte traÃ§abilitÃ©","ProcÃ©dure de correction"],"vigilance":["Hoax viraux","Pression temps rÃ©el","Contraintes antenne"],"indicateurs":["Erreurs Ã©vitÃ©es","DÃ©lai vÃ©rifâ†’antenne","Transparence mÃ©thodo"],"citation":"Â« Sur le terrain : du sÃ»r, du simple, du prouvable. Â»"},
  {"id":"p10","nom":"Persona J","role":"DÃ©veloppeuse (service public, outillage analystes)","niveau_osint":"Moyen","niveau_ia":"IntÃ©grÃ©e ou en dÃ©veloppement","fonction":"Mobilisation","silhouette":"longhair","famille":"Gestionnaires techniques et solutionnistes","pitch":"DÃ©veloppe des services ad hoc pour lâ€™autonomie des analystes (datalab, pipelines).","objectifs":["Outiller sans enfermer","RÃ©duire travail rÃ©pÃ©titif","Journaliser pour auditabilitÃ©"],"outils":["ETL/ELT","Index hybrides","Dashboards","CI/CD & monitoring"],"besoins":["SpÃ©cifs claires","DonnÃ©es ouvertes/fiables","Budget maintenance"],"vigilance":["Verrous API","Bruit algorithmique","Dette technique & docs"],"indicateurs":["Adoption analystes","Temps gagnÃ©/tÃ¢che","Bugs rÃ©solus en continu"],"citation":"Â« Un bon outil augmente lâ€™analyste et reste portable. Â»"},
  {"id":"p11","nom":"Persona K","role":"Analyste (service public, lutte dÃ©sinformation)","niveau_osint":"Fort","niveau_ia":"Exploratoire ou ponctuelle","fonction":"Orientationnelle","silhouette":"neutral","famille":"EnquÃªteurs augmentÃ©s","pitch":"Veille/alerte â€˜idÃ©aleâ€™ : signaux pertinents, explicables, priorisÃ©s.","objectifs":["DÃ©tection prÃ©coce & priorisation","RÃ©duire le bruit","TraÃ§abilitÃ© pour qualification"],"outils":["Clustering thÃ©matique","ASR/transcription","Analyse vignettes vidÃ©o","Tableaux de preuve"],"besoins":["Seuils configurables","Transparence modÃ¨les/versions","ExplicabilitÃ© des alertes"],"vigilance":["Surveillance excessive","Biais dâ€™attribution","RÃ¨gles de rÃ©tention"],"indicateurs":["DÃ©lai alerteâ†’qualification","% alertes pertinentes","ReproductibilitÃ© dâ€™analyse"],"citation":"Â« Alerter utilement â€” et lâ€™expliquer. Â»"}
];

function personaCard(p){
  const svg = SILH[p.silhouette||'neutral'];
  const famColor = (FAMILLE_COLORS[p.famille]||'#93c5fd');
  const famChip = p.famille ? `<span class='chip'>ğŸ·ï¸ ${p.famille}</span>` : '';
  const chips = [`OSINT : ${p.niveau_osint}`, `IA : ${p.niveau_ia}`, `ğŸ§­ ${p.fonction}`].map(x=>`<span class="chip">${x}</span>`).join('') + famChip;
  return `
  <article class="card" style="--card-color:${famColor}" data-os="${p.niveau_osint}" data-ia="${p.niveau_ia}" data-fn="${p.fonction}" data-fam="${p.famille}" data-text="${[p.nom,p.role,p.pitch,(p.outils||[]).join(' '),(p.besoins||[]).join(' '),(p.vigilance||[]).join(' ')].join(' ').toLowerCase()}">
    <div class="head"><div class="illu">${svg}</div><div class="meta"><div class="title">${p.nom} â€” ${p.role}</div><div class="kicker">${p.pitch}</div><div class="chips">${chips}</div></div></div>
    <div class="body">
      <div><h4>ğŸ¯ Objectifs</h4><ul>${p.objectifs.map(x=>`<li>${x}</li>`).join('')}</ul><h4>ğŸ§° Outils clÃ©s</h4><ul>${p.outils.map(x=>`<li>${x}</li>`).join('')}</ul></div>
      <div><h4>ğŸ¤ Besoins</h4><ul>${p.besoins.map(x=>`<li>${x}</li>`).join('')}</ul><h4>âš ï¸ Points de vigilance</h4><ul>${p.vigilance.map(x=>`<li>${x}</li>`).join('')}</ul><h4>ğŸ“ Indicateurs</h4><ul>${p.indicateurs.map(x=>`<li>${x}</li>`).join('')}</ul>
        <p class="note">Â« ${p.citation} Â»</p>
        <h4>ğŸ”— Liens croisÃ©s</h4>
        <ul><li><a href="matrice.html#cards" target="_blank" rel="noopener">Fiches MatrioscIA (profils)</a></li><li><a href="matrice.html#tabCats" target="_blank" rel="noopener">Tableau des catÃ©gories</a></li><li><a href="matrice.html#matrixWrap" target="_blank" rel="noopener">Matrice 3Ã—3</a></li></ul>
      </div>
    </div>
  </article>`;
}

const cards = document.getElementById('cards');
cards.innerHTML = PERSONAS.map(personaCard).join('');

// Filtres
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const q = $('#q'), os = $('#os'), ia = $('#ia'), fam = $('#fam'), fn = $('#fn');

function initFromURL(){
  const u = new URL(window.location.href);
  const fam_p = u.searchParams.get('famille');
  const os_p = u.searchParams.get('osint');
  const ia_p = u.searchParams.get('ia');
  const fn_p = u.searchParams.get('fonction');
  if(os_p) os.value = os_p;
  if(ia_p) ia.value = ia_p;
  if(fn_p) fn.value = fn_p;
  if(fam_p) fam.value = fam_p;
}

function applyFilters(){
  const qv = (q.value||'').toLowerCase();
  const osv = os.value, iav = ia.value, famv = fam.value, fnv = fn.value;
  $$('#cards .card').forEach(card=>{
    const ok =
      (!osv || card.dataset.os === osv) &&
      (!iav || card.dataset.ia === iav) &&
      (!famv || card.dataset.fam === famv) &&
      (!fnv || card.dataset.fn === fnv) &&
      (card.dataset.text.includes(qv));
    card.style.display = ok ? '' : 'none';
  });
}
initFromURL();
[q, os, ia, fam, fn].forEach(el=>{ el.addEventListener('input', applyFilters); el.addEventListener('change', applyFilters); });
applyFilters();

$('#themeBtn').addEventListener('click', ()=>{ document.documentElement.classList.toggle('light'); });
$('#exportBtn').addEventListener('click', ()=>{
  const blob = new Blob([JSON.stringify(PERSONAS, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'personas_matrioscia.json'; a.click(); URL.revokeObjectURL(url);
});
</script>
</html>
